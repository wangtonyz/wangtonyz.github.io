#!/bin/sh
# pre-push hook: éªŒè¯commitæ¶ˆæ¯æ ¼å¼
echo "ğŸ” æ£€æŸ¥commitæ¶ˆæ¯æ ¼å¼..."

# è·å–æœ€åä¸€æ¡commitæ¶ˆæ¯
COMMIT_MSG=$(git log -1 --pretty=%B)

# æ£€æŸ¥commitæ¶ˆæ¯æ˜¯å¦ç¬¦åˆConventional Commitsæ ¼å¼
if ! echo "$COMMIT_MSG" | grep -qE '^(feat|fix|docs|style|refactor|perf|test|chore|ci)(\(.+\))?:'; then
  echo "âŒ Commitæ¶ˆæ¯æ ¼å¼ä¸ç¬¦åˆè§„èŒƒï¼"
  echo "è¯·ä½¿ç”¨ä»¥ä¸‹æ ¼å¼ï¼š"
  echo "  feat(scope): æ–°åŠŸèƒ½æè¿°"
  echo "  fix(scope): ä¿®å¤bugæè¿°"
  echo "  docs: æ–‡æ¡£å˜åŒ–"
  echo "  style: ä»£ç é£æ ¼å˜åŒ–"
  echo "  refactor: ä»£ç é‡æ„"
  echo "  perf: æ€§èƒ½ä¼˜åŒ–"
  echo "  test: æ·»åŠ æµ‹è¯•"
  echo "  chore: æ„å»ºæˆ–ä¾èµ–å˜åŒ–"
  echo "  ci: CIé…ç½®å˜åŒ–"
  exit 1
fi

echo "âœ… Commitæ¶ˆæ¯æ ¼å¼æ­£ç¡®"
echo "âœ… pushå‰æ£€æŸ¥å®Œæˆï¼Œç»§ç»­æäº¤..."
exit 0
